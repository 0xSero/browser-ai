function markedHighlight(a){if((a="function"==typeof a?{highlight:a}:a)&&"function"==typeof a.highlight)return"string"!=typeof a.langPrefix&&(a.langPrefix="language-"),"string"!=typeof a.emptyLangClass&&(a.emptyLangClass=""),{async:!!a.async,walkTokens(e){if("code"===e.type){var t=getLang(e.lang);if(a.async)return Promise.resolve(a.highlight(e.text,t,e.lang||"")).then(updateToken(e));t=a.highlight(e.text,t,e.lang||"");if(t instanceof Promise)throw new Error("markedHighlight is not set to async but the highlight function is async. Set the async option to true on markedHighlight to await the async highlight function.");updateToken(e)(t)}},useNewRenderer:!0,renderer:{code(e,t,n){"object"==typeof e&&(n=e.escaped,t=e.lang,e=e.text);t=getLang(t),t=t?a.langPrefix+escape(t):a.emptyLangClass,t=t?` class="${t}"`:"";return e=e.replace(/\n$/,""),`<pre><code${t}>${n?e:escape(e,!0)}
</code></pre>`}}};throw new Error("Must provide highlight function")}function getLang(e){return(e||"").match(/\S*/)[0]}function updateToken(t){return e=>{"string"==typeof e&&e!==t.text&&(t.escaped=!0,t.text=e)}}let escapeTest=/[&<>"']/,escapeReplace=new RegExp(escapeTest.source,"g"),escapeTestNoEncode=/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode=new RegExp(escapeTestNoEncode.source,"g"),escapeReplacements={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},getEscapeReplacement=e=>escapeReplacements[e];function escape(e,t){if(t){if(escapeTest.test(e))return e.replace(escapeReplace,getEscapeReplacement)}else if(escapeTestNoEncode.test(e))return e.replace(escapeReplaceNoEncode,getEscapeReplacement);return e}export{markedHighlight};