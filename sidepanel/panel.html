<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Browser AI Agent</title>
  <link rel="stylesheet" href="panel.css">
</head>
<body>

  <div class="container">
    <header class="header">
      <h1>Browser AI</h1>
      <button id="settingsBtn" class="icon-btn" title="Settings">⚙️</button>
    </header>

    <div class="tabs">
      <button id="agentTabBtn" class="tab-btn active" data-tab="agent">Agent</button>
      <button id="deepInsightTabBtn" class="tab-btn" data-tab="deep-insight">Deep-Insight</button>
    </div>

    <!-- Agent Tab Content -->
    <div id="agentView" class="tab-content">
      <div id="chatInterface">
        <div id="chatMessages" class="chat-messages"></div>
        <div class="tool-timeline" id="toolTimeline"></div>
      </div>
      <div class="input-area">
        <textarea id="userInput" placeholder="Type your message..."></textarea>
        <button id="sendBtn" class="send-btn">Send</button>
      </div>
    </div>

    <!-- Deep-Insight Tab Content -->
    <div id="deepInsightView" class="tab-content hidden">
      <div class="deep-insight-container">
        <p class="insight-description">Perform detailed analysis on the current page:</p>
        <div class="insight-actions">
          <button class="insight-btn" data-prompt="Summarize the key points of the current page.">Summarize Page</button>
          <button class="insight-btn" data-prompt="Extract all the main headings from this page.">Extract Headings</button>
          <button class="insight-btn" data-prompt="Analyze the tone and sentiment of the text on this page.">Analyze Tone</button>
          <button class="insight-btn" data-prompt="Extract all links (URLs and their text) from the current page content.">Extract Links</button>
          <button class="insight-btn" data-prompt="Identify and list any questions that are asked in the page content.">Find Questions</button>
        </div>
        <div id="insight-output" class="insight-output">
          <!-- Insight results will be displayed here -->
        </div>
      </div>
    </div>

    <!-- Settings Panel -->
    <div id="settingsPanel" class="settings-panel hidden">
      <h2>Settings</h2>
      
      <div class="form-group">
        <label for="provider">AI Provider</label>
        <select id="provider">
          <option value="openai">OpenAI</option>
          <option value="anthropic">Anthropic</option>
          <option value="custom">Custom (OpenAI Compatible)</option>
        </select>
      </div>

      <div class="form-group">
        <label for="apiKey">API Key</label>
        <input type="password" id="apiKey" placeholder="Enter your API key">
      </div>

      <div class="form-group">
        <label for="model">Model</label>
        <input type="text" id="model" placeholder="e.g., gpt-4o">
      </div>

      <div id="customEndpointGroup" class="form-group" style="display: none;">
        <label for="customEndpoint">Custom Endpoint URL</label>
        <input type="text" id="customEndpoint" placeholder="https://api.example.com/v1/chat/completions">
      </div>

      <div class="form-group">
        <label for="systemPrompt">System Prompt</label>
        <textarea id="systemPrompt" rows="6"></textarea>
      </div>

      <div class="form-group">
        <label for="temperature">Temperature: <span id="temperatureValue">0.7</span></label>
        <input type="range" id="temperature" min="0" max="1" step="0.1" value="0.7">
      </div>

      <div class="form-group">
        <label for="maxTokens">Max Tokens</label>
        <input type="number" id="maxTokens" value="2048">
      </div>

      <div class="form-group">
        <label for="timeout">Timeout (ms)</label>
        <input type="number" id="timeout" value="30000">
      </div>

      <div class="form-group">
        <label for="showThinking">Show Thinking Process</label>
        <select id="showThinking">
          <option value="true">Yes</option>
          <option value="false">No</option>
        </select>
      </div>

      <hr>
      <h3>Backup & Restore</h3>
      <div class="form-group backup-restore">
        <button id="exportSettingsBtn" class="btn">Export Settings</button>
        <label class="btn" for="importSettingsInput">Import Settings</label>
        <input type="file" id="importSettingsInput" accept=".json" style="display: none;">
      </div>
      <hr>

      <div class="settings-actions">
        <button id="saveSettingsBtn" class="btn primary">Save</button>
        <button id="cancelSettingsBtn" class="btn">Cancel</button>
      </div>
    </div>

    <footer id="statusBar" class="status-bar">
      <span id="statusText">Ready</span>
    </footer>
  </div>

  <script src="lib/marked.min.js"></script>
  <script src="panel.js"></script>
</body>
</html>